<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >
<head>
<title>ORCA</title>
<link rel="stylesheet" href="generic2.css" type="text/css" />
</head>
<body>

<!-- Do not edit or remove this line: it causes add_sidebar.pl to add the menu -->


<h1>Developing Components</h1>

<p>To reiterate, components can be developed in any way you choose.
   So long as they implement their interfaces, other components will
   be able to interoperate with them.  This page contains suggestions
   for how to think about components, and how to write them using
   libOrcaIceUtil.  Several of the components in the repository are
   designed in this way.</p>

<p>A basic component template looks like this:</p>

<img src="images/component_design.png">

<p>The main pieces are:</p>

<ul>
  <li><h3>Component</h3>
    <p>Derives from orcaiceutil::Component.</p>

    <p>This the main class which instantiates and contains the other
    pieces.  Deriving from orcaiceutil::Component makes it easy to
    exist within either a stand-alone application or an IceBox
    Service.</p>

    <p>To implement an orcaiceutil::Component, the 'start()' and
     'stop()' functions must be implemented.</p>
  </li>

  <li><h3>Interface Implementation</h3>
    <p>This class implements the methods defined in the Slice
    interface definition, ie it does the talking to the outside world.
    By convention, it it's named &lt;interface_name&gt;I and lives in
    a file called &lt;interface_name&gt;_i.{h|cpp}.</p>

    <p>Remote Method Invocations arrive asynchronously from the
    outside world or from the Main Loop.  Requests from the outside
    world can be answered using the information in the thread-safe
    buffers.</p>
  </li>

  <li><h3>Buffers</h3>
    <p>The buffers are instantiations of orcaiceutil::PtrBuffer.
  They're thread-safe (to handle the concurrency issues presented by
  simultaneous access from MainLoop and the outside world), and
  specially designed for Ice classes.</p>
  </li>

  <li><h3>Main Loop</h3>

    <p>Most (but not all) components need to do some work
    continuously.  MainLoop is the class that holds the thread of
    execution (it derives from orcaiceutil::Thread).</p>

    <p>MainLoop's job is to be an intermediary between
    Hardware/Algorithm and Interface_Implementation (via the Buffers).
    A loop might look somthing like this (going vaguely clockwise in the figure):</p>

    <ol>
      <li>Check if new requests have arrived at the Buffers
      <li>Hand the request(s) to the Hardware/Algorithm
      <li>Read the data information generated by the Hardware/Algorithm (a blocking call)
      <li>Send that data to the world via IceStorm
      <li>Hand the data to the Buffers so the world can query it directly
      <li>Goto step 1
    </ol>

  </li>

  <li><h3>Hardware/Algorithm</h3>

    <p>This is the part that actually does the work.  It may have its own internal threads.</p>

  </li>

</ul>

<p>The purpose of designing in this way is try to separate (a) network
communication, (b) sequence of control (including setup/shutdown,
component life-cycle), and (c) the algorithm or hardware driver itself.</p>




<!-- Do not edit or remove this line: it causes add_sidebar.pl to add the footer -->


</body>
</html>
